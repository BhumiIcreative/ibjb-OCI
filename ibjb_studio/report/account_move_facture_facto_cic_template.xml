<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!--Report template for Facto Invoice (cic)-->
    <template id="facture_facto_cic_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.external_layout">
                    <div class="page">
                        <div class="row">
                            <div class="col">
                                <span>
                                    <i style="font-size: 11px;">15F InvoiceFR facto Rev A 07/2020</i>
                                </span>
                            </div>
                        </div>
                        <div class="row address">
                            <div class="col-5"/>
                            <div class="col-5 offset-2">
                                <div t-field="doc.partner_id"
                                     t-options='{"widget": "contact", "fields": ["name", "address"]}'/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <span style="margin-left:505px;">
                                    <b>VAT No.:
                                        <span t-field="doc.partner_id.vat"/>
                                        <br/>
                                    </b>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <span style="margin-left:505px;">
                                    <b>Customer code:
                                        <span t-field="doc.partner_id.customer_code"/>
                                        <br/>
                                    </b>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <span>Please make an electronic transfer "all bank charges for the applicant".
                                    <br/>
                                    <b>Banque CIC - CM-CIC FACTOR</b>
                                    <br/>
                                    <b>IBAN</b>: FR76 1197 8000 0101 3312 17070 74
                                    <br/>
                                    <b>BIC :</b>
                                    CMCIFRPPXXX
                                    <br/>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div t-if="doc.move_type == 'out_invoice'" class="col h2" style="margin-top:15px;">
                                <span style="margin-left:50px;">Invoice No.
                                    <span t-field="doc.name"/>
                                    <br/>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div t-if="doc.move_type == 'out_refund'" class="col h2" style="margin-top:10px;">
                                <span style="margin-left:50px;">To have</span>
                                <span t-field="doc.name"/>
                            </div>
                        </div>
                        <div class="row" style="margin-top:15px;">
                            <div class="col-auto mw-100 mb-2">
                                <span>
                                    <strong>Your reference:</strong>
                                    <br/>
                                </span>
                                <span t-field="doc.name"/>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <span>
                                    <strong>Invoice date:</strong>
                                    <br/>
                                </span>
                                <span t-field="doc.invoice_date"/>
                            </div>
                            <div class="col-auto mw-100 mb-2">
                                <span>
                                    <strong>Order No.:</strong>
                                    <br/>
                                </span>
                                <span t-field="doc.invoice_origin"/>
                            </div>
                        </div>
                        <table class="table o_report_block_table" style="margin-top:30px;">
                            <thead>
                                <tr>
                                    <th class="align-middle text-center">
                                        <span>Article reference</span>
                                    </th>
                                    <th class="align-middle text-center">
                                        <span>Description</span>
                                    </th>
                                    <th class="align-middle text-center">
                                        <span>Quantity</span>
                                    </th>
                                    <th class="align-middle text-center">
                                        <span>Unit price excluding VAT</span>
                                    </th>
                                    <th class="align-middle text-center">
                                        <span>VAT</span>
                                    </th>
                                    <th class="align-middle text-center">
                                        <span>Amount (excl. VAT)</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="doc.invoice_line_ids" t-as="table_line" t-esc-options='{"last": true}'
                                    class="table table-sm o_main_table">
                                    <!-- Apply styles conditionally based on whether this is the last row -->
                                    <td t-if="table_line == doc.invoice_line_ids[-1]"
                                        style="border-bottom: 1px solid black;">
                                        <span t-field="table_line.product_id.default_code"/>
                                    </td>
                                    <td t-else="" style="border-bottom: hidden;">
                                        <span t-field="table_line.product_id.default_code"/>
                                    </td>

                                    <td t-if="table_line == doc.invoice_line_ids[-1]"
                                        style="border-bottom: 1px solid black;">
                                        <span t-field="table_line.name"/>
                                    </td>
                                    <td t-else="" style="border-bottom: hidden;">
                                        <span t-field="table_line.name"/>
                                    </td>

                                    <td t-if="table_line == doc.invoice_line_ids[-1]"
                                        style="border-bottom: 1px solid black;">
                                        <span t-field="table_line.product_uom_id.display_name"/>
                                    </td>
                                    <td t-else="" style="border-bottom:hidden;">
                                        <span t-field="table_line.product_uom_id.display_name"/>
                                    </td>

                                    <td t-if="table_line == doc.invoice_line_ids[-1]"
                                        style="border-bottom: 1px solid black;">
                                        <span t-field="table_line.price_unit"/>
                                        <span>€</span>
                                    </td>
                                    <td t-else="" style="border-bottom: hidden;">
                                        <span t-field="table_line.price_unit"/>
                                        <span>€</span>
                                    </td>

                                    <td t-if="table_line == doc.invoice_line_ids[-1]"
                                        style="border-bottom: 1px solid black;">
                                        <t t-foreach="table_line.tax_ids" t-as="tax">
                                            <span t-field="tax.description"/>
                                        </t>
                                    </td>
                                    <td t-else="" style="border-bottom: hidden;">
                                        <t t-foreach="table_line.tax_ids" t-as="tax">
                                            <span t-field="tax.description"/>
                                        </t>
                                    </td>

                                    <td t-if="table_line == doc.invoice_line_ids[-1]" class="text-right"
                                        style="border-bottom: 1px solid black;">
                                        <span t-field="table_line.price_subtotal"/>
                                    </td>
                                    <td t-else="" class="text-right" style="border-bottom: hidden;">
                                        <span t-field="table_line.price_subtotal"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="row">
                            <div class="col-5"/>
                            <div class="col-5 offset-2">
                                <table class="table table-sm o_report_block_total">
                                    <t t-set="tax_totals" t-value="doc.tax_totals or {}"/>
                                    <t t-call="account.document_tax_totals"/>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <span style="margin-top:10px;">
                                    <b>CM-CIC Factor within the scope of the article L313-23 to L313-35 of
                                        the french financial and monetary code. In order to be fully discharged
                                        from this Debt, payment should be made by check to<br/>CM-CIC Factor<br/>CIC
                                        Direction des Grands Comptes<br/>57, rue de la Victoire 75009 PARIS France
                                        <br/>
                                        Tel : +33(1).49.74.56.00<br/>Or by wire transfer :<br/>Bank CIC - CM-CIC Factor
                                        - BIC CMCIFRPPXXX - IBAN FR76 1197 8000 0101 3676 17070 55
                                        <br/>
                                    </b>
                                    <br/>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" style="margin-top:20px;">
                                <span t-field="doc.narration"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" style="margin-top:10px;">
                                <span>
                                    <font style="font-size: 11px;">
                                        <font style="font-size: 10px;">Any amount including VAT not paid on the due date
                                            will give rise to the payment of penalties by the
                                            customer. The interest rate for late payment penalties is equal to
                                            the most recent half-yearly key rate (refinancing rate or Refi) of the
                                            European Central Bank (ECB) plus 10 points.
                                            These penalties are due automatically and will be automatically debited
                                            from the customer account. No reminder or formal notice is
                                            necessary to incur late payment penalties. They start to run from the
                                            day following the payment date shown on the invoice. In addition,
                                            we reserve the right to suspend delivery of current orders. No discount will
                                            be granted in the event of early payment. In
                                            the event of late payment, the buyer will owe a fixed compensation
                                            for recovery costs in the amount of 40 euros, automatically and
                                            without prior notification. We may ask the buyer for additional compensation
                                            if the recovery costs actually incurred exceed this amount, upon
                                            presentation of supporting documents.
                                        </font>
                                    </font>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" style="margin-top:10px;">
                                <b>Delivery address:
                                    <br/>
                                </b>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-3">
                                <div t-field="doc.partner_shipping_id"
                                     t-options='{"widget": "contact", "fields": ["name", "address"]}'/>
                            </div>
                            <div class="col-3">
                                <span>
                                    <strong>Payment Terms:</strong>
                                    <br/>
                                </span>
                                <span t-field="doc.invoice_payment_term_id.name"/>
                            </div>
                            <div class="col-3">
                                <span>
                                    <strong>Due date:</strong>
                                    <br/>
                                    <span t-field="doc.invoice_date_due"/>
                                </span>
                            </div>
                            <div class="col-3"/>
                        </div>
                        <div class="row">
                            <div t-if="doc.partner_id.lang == 'en_US'" class="col" style="margin-top:10px;">
                                <span>We certify that all the goods are French origin and can circulate in the European
                                    Community.
                                </span>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
    <template id="tax_groups_totals_inherit" inherit_id="account.tax_groups_totals">
        <xpath expr="//t[1]/tr[1]/t[1]/td[1]/span[2]" position='replace'/>
        <xpath expr="//t[@t-else='']/td[1]/span[2]" position='replace'>
        </xpath>
        <xpath expr="//t[@t-else='']/td[1]/span[2]" position='replace'>
        </xpath>
    </template>
</odoo>